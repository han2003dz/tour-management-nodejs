extends ../../layouts/default.pug
include ../../mixins/filterStatus.pug
include ../../mixins/alert.pug
include ../../mixins/search.pug
include ../../mixins/changeMulti.pug
include ../../mixins/moment.pug
block main
  .link-router.my-3
    a(href=`#` class="text-decoration-none ms-2 text-dark")
      i.fas.fa-columns.me-2
      span Management 
    span /
    a(href=`${prefixAdmin}/categories` class="text-decoration-none ms-2")
      span Categories
  .card
    .card-header
      i.fas.fa-table.me-1
      | Danh sách danh mục
    .card-body
      .row.border-bottom.pb-2
        .col-5
          +filter(filterStatus)
        .col-4.ms-auto.d-flex.justify-content-end
          +search(keyword)
        .col-2.d-flex.justify-content-end
          a(href=`${prefixAdmin}/categories/create` class="ml-auto")
            button(class="btn btn-sm btn-outline-success") + Thêm mới
      .row.border-bottom.mb-2
        +form-change-multi(`${prefixAdmin}/categories/change-multi?_method=PATCH`)
      if(categories.length > 0)
        table#datatablesSimple(checkbox-multi)
          thead
            tr
              th 
                input(class="form-check-input checkAll" type="checkbox" name="checkAll")
              th STT
              th 
                span(class="imageAll") Hình ảnh
              th Tên danh mục
              th(class="text-center")
                span(class="statusAll") Trạng thái
              th 
                span Người cập nhật gần nhất
              th 
                span(class="actionAll") Hành động
          tbody
            each item, index in categories
              tr
                td 
                  input(
                    class="form-check-input"
                    type="checkbox"
                    name="check-item"
                    value=item.id
                  )
                td #{index + 1}
                td 
                  img(
                    class="img-categories"
                    src=item.images[0]
                    alt=item.title
                    width="90px"
                    height="50px"
                  )
                td #{item.title}
                td(class="text-center")
                  a(href="#" 
                    class="badge" 
                    data-status=item.status
                    data-id=item.id
                    link-change-status
                  ) 
                    i(
                      class=item.status === "active" ? "fa-solid fa-circle text-success" : "fa-solid fa-circle text-secondary"
                    )
                td 
                  - const updatedBy = item.updatedBy.slice(-1)[0];
                  p
                    | Nguyễn Hân
                  p 
                    +formatDateTime(updatedBy.updatedAt)
                td
                  a(class="btn btn-primary btn-sm" 
                    href=`${prefixAdmin}/categories/detail/${item.id}`
                  )
                    i(class="fa-solid fa-eye")
                  a(class="btn btn-warning btn-sm mx-1" 
                    href=`${prefixAdmin}/categories/edit/${item.id}`
                  )
                    i(class="fa-solid fa-pen-to-square")
                  button(class="btn btn-danger btn-sm" 
                    data-id=item.id 
                    button-delete
                  )
                    i(class="fa-solid fa-trash")
                
      else
        p.text-center Chưa có danh mục nào!      
  form(
    action=""
    method="POST"
    id="form-change-status"
    data-path=`${prefixAdmin}/categories/change-status`
  ) 
  form(
    action=""
    method="POST"
    id="form-delete-record"
    data-path=`${prefixAdmin}/categories/delete`
  )